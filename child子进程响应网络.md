# 子进程工作

## 子进程初始化

1. 自动加载路径设置
2. 如果有监听的端口，则为监听设置事件处理器(event-loop)
3. 将父进程的信号全部重置,添加到事件处理器上
4. 处理定时器
5. 执行onWorkerStart回调函数
6. 执行事件处理器的循环

可以看到子进程的最主要的工作是执行事件处理器,但是子进程不是**一个**worker实例,子进程是event-loop实例，其中最主要运行的正是全局静态的event-loop，而worker实例只是作为一个具体的消息接收、发送的处理过程。

## event-loop

以select系统调用为例，说明一下IO多路复用的实现

### 初始化

stream_socket_pair创建一对unix套接字,并将其读端加入到事件队列中(事件循环如果不存在任何一个句柄则会空转，主要针对于只在worker进程中使用定时器，而不加入tcp/udp/http等网络事件)。